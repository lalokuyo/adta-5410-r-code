<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Week 4 Assignment: Eduardo Banuelos</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="Week 4 Assignment_files/libs/clipboard/clipboard.min.js"></script>
<script src="Week 4 Assignment_files/libs/quarto-html/quarto.js"></script>
<script src="Week 4 Assignment_files/libs/quarto-html/popper.min.js"></script>
<script src="Week 4 Assignment_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Week 4 Assignment_files/libs/quarto-html/anchor.min.js"></script>
<link href="Week 4 Assignment_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Week 4 Assignment_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Week 4 Assignment_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Week 4 Assignment_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Week 4 Assignment_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Week 4 Assignment: Eduardo Banuelos</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="business-problem" class="level2">
<h2 class="anchored" data-anchor-id="business-problem">Business Problem</h2>
<p>You work for a consulting company to understand the factors on which professional Baseball playersâ€™ salaries depend.</p>
<p>You are given individual data for professional players in the Major League along with their 1986 performance measures and 1987 salary.</p>
<p>The business goal of the consulting firm is to model the logged salary of professional Baseball players with the available independent variables. Your findings will be used by the company clients to understand how exactly the logged salaries vary with the independent variables.</p>
<p>The data consists of 263 observations of 16 attributes. Below is a brief description of the variables in the data:</p>
<p><strong>Attributes:</strong></p>
<ul>
<li><p><strong>CrAtBat</strong> Career Times at Bat</p></li>
<li><p><strong>CrBB</strong> Career Walks</p></li>
<li><p><strong>CrHits</strong> Career Hits</p></li>
<li><p><strong>CrHome</strong> Career Home Runs</p></li>
<li><p><strong>CrRbi</strong> Career RBIs</p></li>
<li><p><strong>CrRuns</strong> Career Runs</p></li>
<li><p><strong>YrMajor</strong> Years in the Major Leagues</p></li>
<li><p><strong>nAssts</strong> Assists in 1986</p></li>
<li><p><strong>nAtBat</strong> Times at Bat in 1986</p></li>
<li><p><strong>nBB</strong> Walks in 1986</p></li>
<li><p><strong>nError</strong> Errors in 1986</p></li>
<li><p><strong>nHits</strong> Hits in 1986</p></li>
<li><p><strong>nHome</strong> Home Runs in 1986</p></li>
<li><p><strong>nOuts</strong> Put Outs in 1986</p></li>
<li><p><strong>nRBI</strong> RBIs in 1986</p></li>
<li><p><strong>nRuns</strong> Runs in 1986</p></li>
</ul>
<p><strong>Outcome:</strong></p>
<p><strong>LogSalary</strong>: Log of 1987 Salary in $ Thousands</p>
<p>Below, the dataset is loaded and then split into a train and test sets in a 80:20 ratio. Your job is to use the training set to build the models in Parts 1-3. In Part 4, you will use the test set to check the model performance.</p>
<section id="do-not-change-anything-in-this-r-chunk.-just-run-the-code-chunk-and-move-to-the-next-one" class="level4">
<h4 class="anchored" data-anchor-id="do-not-change-anything-in-this-r-chunk.-just-run-the-code-chunk-and-move-to-the-next-one">Do not change anything in this r chunk. Just run the code chunk and move to the next one</h4>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: Matrix</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loaded glmnet 4.1-7</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> int [1:52] -193 -54 -216 -194 -20 -140 -190 -19 -90 -254 ...</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>    nAtBat nHits nHome nRuns nRBI nBB YrMajor CrAtBat CrHits CrHome CrRuns
1      181    41     1    15   21  33       2     232     50      4     20
2      209    54     3    25   14  12       1     209     54      3     25
3      185    37     1    23    8  21       2     214     42      1     30
4      214    53     2    30   29  23       2     226     59      2     32
7      312    68     2    32   22  24       1     312     68      2     32
8      323    81     6    26   32   8       2     341     86      6     32
9      199    53     5    29   22  21       3     514    120      8     57
10     165    39     2    13    9  16       3     196     44      2     18
11     279    64     0    31   26  30       1     279     64      0     31
12     216    54     2    27   25  33       1     216     54      2     27
13     399   102     3    56   34  34       5     670    167      4     89
15     445    99     1    46   24  29       4     618    129      1     72
16     268    60     5    24   25  15       2     350     78      5     34
17     416   113    24    58   69  16       1     416    113     24     58
18     185    40     4    23   11  18       3     524    125      7     58
21     633   210     6    91   56  59       6    3070    872     19    420
23     151    41     4    26   21  19       2     288     68      9     45
24     382   101    16    50   55  22       1     382    101     16     50
25     298    73     0    24   24   7       3     509    108      0     41
26     413    92    16    72   48  65       1     413     92     16     72
27     438   103     2    65   32  71       2     440    103      2     67
28     341    95     6    48   42  20      10    2964    808     81    379
30     512   117    29    54   88  43       6    1750    412    100    204
33     419   108     6    55   36  22       3     591    149      8     80
34     280    82    16    44   45  47       2     428    113     25     61
35     278    86     4    33   38  45       1     278     86      4     33
36     315    73     5    23   37  16       4     450    108      6     38
37     426   109     3    55   43  62       1     426    109      3     55
38     211    43    10    26   35  39       3     498    116     14     59
40     328    91    12    51   43  33       2     342     94     12     51
41     309    72     0    33   31  26       5     354     82      0     41
42     127    32     8    16   22  14       8     727    180     24     67
43     461   112    18    54   54  35       2     680    160     24     76
44     258    60     8    28   33  18       3     638    170     17     80
45     299    75     6    38   23  26       3     580    160      8     71
46     208    57     8    32   25  18       3     653    170     17     98
49     338    92    18    42   60  21       3     682    185     36     88
50     407    93     8    47   30  30       2     969    230     14    121
52     472   118    12    63   54  30       4     793    187     14    102
53     315    76    13    35   60  25       3     630    151     24     68
55     578   138     1    56   59  34       3    1399    357      7    149
57     600   144    33    85  117  65       2     696    173     38    101
58     593   172    22    82  100  57       1     593    172     22     82
59     540   135    30    82   88  55       1     540    135     30     82
60     190    46     2    24    8  15       5     479    102      5     65
61     143    39     5    18   30  15       9     639    151     16     80
62     504   120    28    71   71  54       3    1085    259     54    150
63     547   137     2    58   47  12       2    1038    271      3    129
65     520   120    17    53   44  21       4     927    227     22    106
66     236    56     6    41   19  21       5    1257    329     24    166
67     402   108     9    63   48  40       4    1034    278     16    135
68     275    68     5    42   42  61       6     961    238     16    128
69     453   101     3    46   43  61       3     948    218      6     96
70     354    77    16    36   55  41      20    8716   2172    384   1172
71     616   163    27    83  107  32       3    1437    377     65    181
75     351    97     4    55   29  39       4    1258    353     16    196
76     576   167     8    89   49  57       4     822    232     19    132
77     416   132     7    57   49  33       3     932    273     24    113
79     466   108    33    75   86  72       3     652    142     44    102
80     216    53     1    31   15  22       4     926    210      9    118
81     283    70     8    33   37  27      12    4479   1222     94    557
82     236    56     0    27   15  11       4    1115    270      1    116
83     213    61     4    17   22   3      17    4061   1145     83    488
84     196    43     7    29   27  30      13    3231    825     36    376
85     288    76     7    34   37  15       4    1644    408     16    198
87     205    57     8    34   32   9       5     756    192     32    117
88     663   200    29   108  121  32       4    1447    404     57    210
89     257    66     5    31   26  32      14    3910    979     33    518
91     246    76     5    35   39  13       6     912    234     12    102
92     394    86     1    38   28  36       4    1089    267      3     94
94     155    41    12    21   29  22      16    5409   1338    181    746
95     199    52     9    26   28  21       6     805    191     30    113
96     155    44     6    21   23  15      16    6631   1634     98    698
98     160    39     8    18   31  22      14    2128    543     56    304
100    279    69     4    35   31  32       4    1359    355     31    180
101    205    43     2    24   17  20       7     854    219     12    105
102    220    54    10    30   39  31       5    1185    299     40    145
103    204    49     6    23   25  12       7    1309    308     27    126
104    415   115    27    97   71  68       3     711    184     45    156
105    404    92    11    54   49  18       6    1354    325     30    188
106    344    85    24    69   64  88       7     911    214     64    150
107    357    96     7    50   45  39       5    1394    344     43    178
108    254    68     2    28   26  22       6     999    236     21    108
109    311    81     3    42   30  26      17    8247   2198    100    950
110    388   103    15    59   47  39       6    2174    555     80    285
111    278    70     7    22   37  18      18    7186   2081    190    935
112    368   103     3    48   28  54       8    1897    493      9    207
113    244    58     9    28   25  35       4    1335    333     49    164
114    288    63     3    25   33  16      10    2682    667     38    315
115    281    76     3    42   25  20       8    2658    657     48    324
116    369    93     9    43   42  49       5    1258    323     54    181
117    528   122     1    67   45  51       4    1716    403     12    211
118    687   213    10    91   65  27       4    1518    448     15    196
119    327    85     3    30   44  20       8    2140    568     16    216
120    210    70    13    32   51  28      15    4040   1130     97    544
121    680   223    31   119   96  34       3    1928    587     35    262
122    233    49     2    41   23  18       8    1350    336      7    166
123    325    76    16    33   52  37       5    1506    351     71    195
124    475   126     3    61   43  52       6    1700    433      7    217
125    539   139     5    93   58  69       5    1469    369     12    247
126    340    84    11    62   33  47       5    1516    376     42    284
127    327    68    13    42   29  45      18    3949    939     78    438
128    205    52     8    31   27  17      12    5134   1323     56    643
129    405   102    18    49   85  20       6     950    231     29     99
130    313    78     6    32   41  12      12    3742    968     35    409
131    584   157    20    95   73  63      10    4704   1320     93    724
132    376    82    21    42   60  35       5    1770    408    115    238
133    265    68     8    26   30  29       7    1337    339     32    135
134    441   113     5    76   52  76       5    1546    397     17    226
136    314    83    13    39   46  16       5    1457    405     28    156
137    255    70     7    49   35  43      15    6311   1661    154   1019
138    184    47     5    20   28  18      11    3327    890     74    419
139    313    83     9    43   41  30      14    5885   1543    104    751
141    348    90    11    50   45  43      10    2288    614     43    295
142    315    81     7    24   38  39      14    3449    835     69    321
143    458   114    13    67   57  48       4    1350    298     28    160
144    530   159     3    82   50  47       6    1619    426     11    218
145    479   130    18    66   72  76       3    1624    457     63    224
146    419   101    18    65   58  92      20    9528   2510    548   1509
147    424   110    15    70   47  36       7    2130    544     38    335
148    496   141    20    65   78  37      11    5628   1575    225    828
149    282    78    13    37   51  29       5    1649    453     73    211
150    486   145    11    51   76  40      11    3967   1102     67    410
151    127    32     4    14   25  12      19    8396   2402    242   1048
153    574   159    21   107   75  59      10    4631   1300     90    702
154    491   141    11    77   47  37      15    4291   1240     84    615
156    562   169    17    88   73  53       8    3181    841     61    450
157    507   122    29    78   85  91      18    7761   1947    347   1175
158    408    94     4    42   36  66       9    3573    866     59    429
159    418   113    13    48   61  47       4    1512    392     41    205
160    442   131    18    68   77  33       6    1416    398     47    210
161    387   124     1    67   27  36       7    1775    506      6    272
162    341   110     9    45   49  46       9    2331    658     50    249
163    625   179     4    94   60  65       5    1696    476     12    216
164    473   154     6    61   48  29       6    1966    566     29    250
165    464   128    28    67   94  52      13    5829   1552    210    740
166    382   119    13    54   58  36      12    2133    594     41    287
167    472   116    16    60   62  74       6    1924    489     67    242
168    329    83     9    50   39  56       9    3828    948    145    575
170    309    94     5    37   32  26      13    4618   1330     57    616
171    583   168    17    83   80  56       5    1646    452     44    219
173    560   161    26    89   96  66       4    1789    470     65    233
174    591   184    20    83   79  38       5    1689    462     40    219
175    591   157    16    90   78  26       4    2020    541     52    310
176    288    65     8    30   36  27       9    2815    698     55    315
177    579   174     7    67   78  58       6    3053    880     32    366
178    584   158    15    70   84  42       5    2358    636     58    265
179    330    77    19    47   53  27       6    1928    516     90    247
180    403   101    12    45   53  39      12    5150   1429    166    747
181    239    60     0    30   11  22       6    1941    510      4    309
183    490   148    14    64   78  49      13    3400   1000    113    445
184    359    80    15    45   48  63       7    1493    359     61    176
185    497   127     7    65   48  37       5    2703    806     32    379
186    324    73     4    32   18  22       7    1931    491     13    291
188    370    96    21    49   46  60      15    6986   1972    231   1070
189    510   126     2    42   44  35      11    5562   1578     44    703
191    627   178    14    68   76  46       6    3146    902     74    494
192    459   113    20    59   57  68      12    5348   1369    155    713
195    474   129    10    50   56  40      10    2331    604     61    246
196    566   154    22    76   84  43      14    6100   1583    131    743
197    306   104    14    50   58  25       7    2954    822     55    313
199    237    52     0    15   25  30      24   14053   4256    160   2165
200    523   135     8    52   44  52       9    3368    895     39    377
202    587   163     4    92   51  70       6    2695    747     17    442
203    479   133    10    48   72  55      17    7472   2147    153    980
204    568   158    20    89   75  73      15    8068   2273    177   1045
207    489   131    19    77   55  34       7    2051    549     62    300
208    589   149    21    89   86  64       7    3558    928    102    513
209    327    84    22    53   62  38      10    4273   1123    212    577
210    381   110     9    61   45  32       7    3015    834     40    451
211    526   146    13    71   70  84       6    2648    715     77    352
212    429    91    12    41   42  57      13    5590   1397     83    578
213    379   106    10    38   60  30      14    6207   1906    146    859
214    512   131    26    69   96  52      14    5347   1397    221    712
215    424   119     6    57   46  13       9    3651   1046     32    461
217    457   101    14    42   63  22      17    6521   1767    281   1003
218    374    94     5    36   26  62       7    1968    519     26    181
219    496   119     8    57   33  21       7    3358    882     36    365
220    492   136     5    76   50  94      12    5511   1511     39    897
224    432   114    12    46   57  37       9    3373    916     82    347
225    559   141     2    48   61  73       8    3162    874     16    421
226    529   137    26    86   97  97      15    6661   1785    291   1082
227    593   152    23    69   75  53       6    2765    686    133    369
228    585   139    31    93   94  62      17    7546   1982    315   1141
229    570   169    21    72   88  38       7    3754   1077    140    492
230    573   144     9    85   60  78       8    3198    857     97    470
231    490   150    21    69   58  35      14    6126   1839    121    983
232    522   163     9    82   46  62      13    7037   2019    153   1043
233    631   170     9    77   44  31      11    4908   1457     30    775
235    637   174    31    89  116  56      14    6727   2024    247    978
236    586   159    12    72   79  53       9    3082    880     83    363
237    256    70    13    42   36  44      16    7058   1845    312    965
239    510   147    10    56   52  53       7    2872    821     63    307
241    484   127    20    66   65  67       7    3006    844    116    436
242    591   168    19    80   72  39       9    4478   1307    113    634
244    589   170    40   107  108  69       6    2325    634    128    371
246    232    55     9    34   23  45      12    4405   1213    194    702
247    441   118    28    84   86  68       8    2723    750    126    433
249    550   147    29    85   91  71       6    2816    815    117    405
250    627   177    25    98   81  70       6    3210    927    133    529
251    557   142    21    58   81  23      18    8759   2583    271   1138
252    441   128    16    70   73  80      14    6675   2095    209   1072
255    551   171    13    94   83  94      13    6090   1840    128    969
256    565   148    24    90  104  77      14    7287   2083    305   1135
257    614   163    29    89   83  75      11    5017   1388    266    813
258    490   125    24    81  105  62      13    6063   1646    271    847
259    514   144     0    67   54  79       9    4739   1169     13    583
260    677   238    31   117  113  53       5    2223    737     93    349
261    552   160    37    97  119  89      15    7292   1954    495   1347
262    618   200    20    98  110  62      13    7127   2163    351   1104
263    495   151    17    61   84  78      10    5624   1679    275    884
    CrRbi CrBB nOuts nAssts nError logSalary
1      29   45   326     29      5  4.212128
2      14   12   102      6      3  4.219508
3       9   24    76    127      7  4.248495
4      32   27   109      7      3  4.248495
7      22   24    86    150     15  4.248495
8      34    8   143    290     19  4.317488
9      40   39   152      3      5  4.317488
10     10   18   332     19      2  4.317488
11     26   30   107    205     16  4.317488
12     25   33   317     36      1  4.317488
13     48   54   211      9      3  4.382027
15     31   48   278    415     16  4.471639
16     29   18   442     59      6  4.499810
17     69   16   203     70     10  4.499810
18     37   47    97      2      2  4.499810
21    230  274   367    432     16  4.499810
23     39   35    28     56      2  4.553877
24     55   22   200      7      6  4.579852
25     37   12   121    283      9  4.605170
26     48   65   280      9      5  4.605170
27     32   71   276      7      9  4.605170
28    428  221   158      4      5  4.605170
30    276  155  1236     98     18  4.605170
33     46   31   226      7      4  4.700480
34     70   63   148      4      2  4.700480
35     38   45   102      4      2  4.700480
36     46   28   227     15      3  4.700480
37     43   62   361     22      2  4.744932
38     55   78   463     32      8  4.787492
40     44   33   145     59      8  4.828314
41     32   26   117    269     12  4.867534
42     82   56   202     22      2  4.905275
43     75   49   111    226     11  4.905275
44     75   36   358     32      8  4.919981
45     33   44   212      1      2  4.941642
46     54   62    42     94     13  4.941642
49    112   50     0      0      0  4.976734
50     69   68   172    317     25  5.010635
52     80   50   228    377     26  5.043425
53     94   55   498     39     13  5.043425
55    161   87   133    371     20  5.075174
57    130   69   319      4     14  5.105945
58    100   57  1222    139     15  5.105945
59     88   55   157      6     14  5.147494
60     23   39   102    177     16  5.164786
61     97   61   138     15      1  5.164786
62    167  114   103    283     19  5.164786
63     80   24   261    459     22  5.164786
65     80   52    70    144     11  5.220356
66    125  105   172      1      4  5.247024
67    125   79   190      2      9  5.247024
68    104  172   181      3      2  5.252273
69     72   91   249    444     16  5.273000
70   1267 1057    83    174     16  5.298317
71    227   82   110    308     15  5.298317
75    110  117   226      7      3  5.347108
76     83   79   325     12      8  5.347108
77    121   80    73    177     18  5.370638
79    109  102   286      8      8  5.370638
80     69  114    73    152     11  5.416100
81    483  307   156      2      2  5.416100
82     64   57   125    199     13  5.438079
83    491  244   178     45      4  5.459586
84    290  238    80     45      8  5.480639
85    120  113   203      3      3  5.480639
87    107   51    58      4      4  5.511411
88    222   68   241      8      6  5.521461
89    324  382    87    166     14  5.521461
91     96   80    44      0      1  5.521461
92     71   76   203    369     16  5.521461
94    805  875   165      9      1  5.560682
95    119   87   235     22      5  5.579730
96    661  777    53     88      3  5.616771
98    268  298    33      3      0  5.616771
100   148  158   133    173      9  5.625821
101    99   71   131      6      1  5.658321
102   154  128    50    136     20  5.695414
103   132   66   419     46      5  5.703782
104   119   99   274      2      7  5.703782
105   135   63   222      5      5  5.703782
106   156  187     0      0      0  5.703782
107   192  136   167      2      4  5.703782
108   117  118   359     30      4  5.720312
109   909  690   153    223     10  5.768321
110   274  186   182      9      4  5.783825
111  1088  643     0      0      0  5.783825
112   162  198   209    246      3  5.788941
113   179  194   142     14      2  5.828946
114   259  204   135    257      7  5.833837
115   300  179   106    144      7  5.833837
116   177  157   149      1      6  5.857933
117   146  155   209    372     17  5.857933
118   137   89   294    445     13  5.857933
119   208   93    91    185     12  5.893024
120   462  551     0      0      0  5.899897
121   201   91   429      8      6  5.899897
122   122  106   102    132     10  5.926926
123   219  214   726     87      3  5.953243
124    93  146    37    113      7  5.953243
125   126  198   462      9      7  5.991465
126   141  219   185      8      4  5.991465
127   380  466   659     53      7  5.991465
128   445  459   155      3      2  5.991465
129   138   64   161     10      3  6.028279
130   321  170   106    206      7  6.032287
131   522  576   276    421     11  6.040255
132   299  157     0      0      0  6.052089
133   163  128    92      5      3  6.052089
134   149  191   160    290     11  6.052089
136   159   76   533     40      4  6.067268
137   608  820    51     54      8  6.109248
138   382  304    49      2      0  6.109248
139   714  535    58    141     23  6.109248
141   273  269    60    176      6  6.109248
142   414  375   632     43     10  6.163315
143   123  122   246    389     18  6.163315
144   149  163   196    354     15  6.163315
145   266  263   880     82     14  6.173786
146  1659 1342     0      0      0  6.189290
147   174  258   292      6      3  6.194405
148   838  354   200     11      3  6.214608
149   280  138   670     57      5  6.214608
150   497  284    88    204     16  6.214608
151  1348  819   167     18      6  6.214608
153   504  488   238    445     22  6.248319
154   430  340   239      8      2  6.263398
156   342  373   351    442     17  6.272877
157  1152 1380   808    108      2  6.282267
158   365  410   282    487     19  6.282267
159   204  203   211     11      7  6.309918
160   203  136   233      7      7  6.309918
161   125  194   186    290     17  6.309918
162   322  274   251      9      4  6.327937
163   163  166   303    450     14  6.354370
164   252  178   846     84      9  6.363028
165   840  452     0      0      0  6.375876
166   294  227    59    156      9  6.388561
167   251  240   518     55      3  6.396930
168   528  635   276      6      2  6.396930
170   522  436   161      3      3  6.396930
171   208  136   109    292     25  6.417549
173   260  155   332      9      8  6.437752
174   195   82   303     12      5  6.445720
175   226   91   290    440     25  6.461468
176   325  189   259     30     10  6.476972
177   337  218   280    479      5  6.487684
178   316  134   331     20      4  6.496021
179   288  161   149      8      6  6.507278
180   666  526   316      6      5  6.514713
181   103  207   121    151      6  6.551080
183   491  301     0      0      0  6.551080
184   202  175   682     93     13  6.551080
185   311  138   325      9      3  6.551080
186   108  180   222      3      3  6.562914
188   955  921   137      5      9  6.597600
189   519  256   207    358     20  6.603266
191   345  242   309    492      5  6.606650
192   660  735     0      0      0  6.606650
195   327  166   732     83     13  6.620073
196   693  300   316    439     10  6.620073
197   377  187   116    222     15  6.620073
199  1314 1566   523     43      6  6.620073
200   284  296   367    475     19  6.620073
202   198  317   434      9      3  6.639876
203  1032  854   237      5      4  6.650710
204   993  732   105    290     10  6.652863
207   263  153   310      9      9  6.659294
208   471  351   371      6      6  6.668863
209   700  334   483     48      6  6.684612
210   249  168   228      7      5  6.684612
211   342  289   303      9      9  6.703188
212   579  644   686     46      4  6.715383
213   803  571    72    170     24  6.745236
214   815  548   119    216     12  6.745236
215   301  112   224    286      8  6.745236
217   977  619   389     39      4  6.774224
218   199  288   756     64     15  6.774224
219   280  165   155    371     29  6.774224
220   451  875   313    381     20  6.774224
224   477  238   692     70      8  6.824374
225   349  359   352    414      9  6.829794
226   949  989   280     10      5  6.838762
227   384  321   315     10      6  6.845880
228  1179  727     0      0      0  6.856462
229   589  263   295     15      5  6.856462
230   420  332  1314    131     12  6.866933
231   707  600    96      5      3  6.907755
232   827  535   352      9      1  6.907755
233   357  249   408      4      3  6.907755
235  1093  495   278      9      9  6.948578
236   477  295   181     13      4  6.950176
237  1128  990    41    118      8  6.956545
239   340  174   810     99     18  7.047517
241   458  377  1231     80      7  7.076090
242   563  319    67    147      4  7.090077
244   376  238   368     20      3  7.120848
246   705  625   623     35      3  7.170120
247   420  309   190      2      2  7.170120
249   474  319  1218    104     10  7.177782
250   472  313   240    482     13  7.207860
251  1299  478  1160     53      7  7.279319
252  1050  695    97    218     16  7.313220
255   900  917  1199    149      5  7.495542
256  1234  791   292      9      5  7.529116
257   822  617   303      6      6  7.549609
258   999  680   869     62      8  7.562978
259   374  528   229    453     15  7.570443
260   401  171  1377    100      6  7.588324
261  1392 1354    78    220      6  7.662624
262  1289  564   330     16      8  7.788419
263  1015  709  1045     88     13  7.807917</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>    nAtBat nHits nHome nRuns nRBI nBB YrMajor CrAtBat CrHits CrHome CrRuns
193    642   211    14   107   59  52       5    2364    770     27    352
54     581   145    17    66   68  21       2     831    210     21    106
216    497   136     7    58   38  26      11    3871   1066     40    450
194    594   169     4    74   51  35      11    4408   1133     19    501
20     220    66     5    20   28  13       3     290     80      5     27
140    271    77     5    35   29  33      12    4933   1358     48    630
190    283    74     4    34   29  22      10    3919   1062     85    505
19     209    56    12    22   36  19       2     216     58     12     24
90     216    56     4    22   18  15      12    2796    665     43    266
254    608   160    28   130   74  89       8    4071   1182    103    862
238    401    92    17    49   66  65      13    5206   1332    253    784
56     600   139     0    94   29  60       2    1236    309      1    201
152    202    53     4    31   26  27       9    1876    467     15    192
253    580   207     8   107   71 105       5    2778    978     32    474
206    629   168    18    73  102  40      18    8424   2464    164   1008
201    480   112    18    50   71  44       7    3031    771    110    338
245    437   123     9    62   55  40       9    4139   1203     79    676
73     522   140    16    73   77  60       4     730    185     22     93
14     181    58     6    34   23  22       1     181     58      6     34
205    599   183    10    80   74  32       5    2482    715     27    330
97     339    96     4    37   29  23       4    1064    290     11    123
5      317    78     7    35   35  32       1     317     78      7     35
22     321    87    10    39   42  30       2     396    101     12     48
47     549   149     7    73   47  42       1     549    149      7     73
243    475   123    27    76   93  72       4    1810    471    108    292
155    360    81     5    37   44  37       7    2268    566     41    279
182    283    77    14    45   47  26      16    6840   1910    259    915
39     408   117    11    66   41  34       1     408    117     11     66
169    380   120     5    54   51  31       8    3118    900     92    444
93     263    70     1    26   23  30       4     888    220      9     83
221    513   137    20    90   95  90      14    5201   1382    166    763
86     193    47    10    21   29  24       6    1136    256     42    129
240    641   198    31   101  108  41       5    2129    610     92    297
78     574   152    31    91  101  64       3     985    260     53    148
198    526   163    12    88   50  77       4    1556    470     38    245
32     453   103     8    53   33  52       2     507    123      8     63
223    172    42     3    17   14  15      10    4086   1150     57    579
29     303    71     3    18   30  36       3     344     76      3     20
135    343   103     6    48   36  40      15    4338   1193     70    581
172    550   152     6    92   37  81       5    2308    633     32    349
99     537   147    23    58   88  47      10    2744    730     97    302
6      215    51     4    19   18  11       1     215     51      4     19
74     431   127     8    77   45  58       2     667    187      9    117
187    503   136     5    62   48  83      10    3423    970     20    408
234    528   132    21    61   74  41       6    2641    671     97    273
31     521   142    20    67   86  45       4     815    205     22     99
48     511   138    25    76   96  61       3     592    164     28     87
222    596   171    34    91  108  52       6    2862    728    107    361
248    610   186    19   107   98  74       6    2728    753     69    399
72     572   152    18   105   49  65       2     978    249     36    168
51     439    96     0    44   36  65       4     711    148      1     68
64     217    46     7    32   19   9       4     694    160     32     86
    CrRbi CrBB nOuts nAssts nError logSalary
193   230  193   337     19      4  6.606650
54     86   40   320    465     32  5.043425
216   367  241   304    347     10  6.745236
194   336  194   282    421     25  6.620073
20     31   15   281     21      3  4.499810
140   435  403    62     90      3  6.109248
190   456  283   145      5      7  6.603266
19     37   19   201      6      3  4.499810
90    304  198   391     44      4  5.521461
254   417  708   426      4      6  7.420579
238   890  866     0      0      0  7.003065
56     69  110   300     12      9  5.075174
152   186  161   304     45     11  6.239301
253   322  417   121    267     19  7.377759
206  1072  402  1067    157     14  6.655012
201   406  239    94    270     16  6.620073
245   390  364    82    170     15  7.138867
73    106   86  1320    166     17  5.298317
14     23   22    88      0      3  4.460144
205   326  158   231    374     18  6.652863
97    108   55   104    213      9  5.616771
5      35   32    45    122     26  4.248495
22     46   33   805     40      4  4.516339
47     47   42   255    450     17  4.941642
243   343  267   226     10      6  7.106606
155   257  246   170    284      3  6.263398
182  1067  546   144      6      5  6.551080
39     41   34   942     72     11  4.787492
169   419  240   237      8      1  6.396930
93     82   86    81    147      4  5.521461
221   734  784   267      5      3  6.802395
86    139  106   299     13      5  5.501258
240   319  117   269     17     10  7.069023
78    173   95  1253    111     11  5.370638
198   167  174   250     11      1  6.620073
32     39   58   289    407      6  4.653960
223   363  406    65      0      0  6.802395
29     36   45   468     47      6  4.605170
135   421  325   211     56     13  6.063785
172   182  308   262    329     16  6.437752
99    351  174    92    257     20  5.625821
6      18   11   116      5     12  4.248495
74     64   88   283      8      3  5.310740
187   303  414    65    258      8  6.586172
234   383  226   885    105      8  6.916054
31    103   78   107    242     23  4.653960
48    110   71   157      7      8  4.976734
222   401  224   118    334     21  6.802395
248   366  286  1182     96     13  7.170120
72     91  101   325     13      3  5.298317
51     56   99   229    406     22  5.010635
64     76   32   307     25      1  5.192957</code></pre>
</div>
</div>
</section>
<section id="part-1-full-model-on-all-regressors" class="level3">
<h3 class="anchored" data-anchor-id="part-1-full-model-on-all-regressors">Part 1: Full Model on All Regressors</h3>
<p>You will only use <strong>trainData</strong> in <strong>Part 1.</strong></p>
<p>By using the <strong>trainData</strong>, fit a standard linear regression with the variable <strong>logSalary</strong> as the response and all other attributes as predictors. Name it as <strong>model_full</strong>.</p>
</section>
</section>
<section id="question-1" class="level2">
<h2 class="anchored" data-anchor-id="question-1">Question #1</h2>
<p>According to the <strong>model_full</strong> results, which regression coefficients are statistically significant at the 99% confidence level? Select all that apply.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Insert your R code for Question 1 in here</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co"># HINT: Check the practice materials to see how one can use which() function along with names () function to extract the coefficients. </span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Your code should print out the list variable names</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co">#attributes(trainData)</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>model_full <span class="ot">&lt;-</span> <span class="fu">lm</span>(logSalary <span class="sc">~</span> nAtBat <span class="sc">+</span> nHits <span class="sc">+</span> nHome <span class="sc">+</span> nRuns <span class="sc">+</span> nRBI <span class="sc">+</span> nBB <span class="sc">+</span> YrMajor <span class="sc">+</span> CrAtBat <span class="sc">+</span> CrHits <span class="sc">+</span> CrHome <span class="sc">+</span> CrRuns <span class="sc">+</span> CrRbi <span class="sc">+</span> CrBB <span class="sc">+</span> nOuts <span class="sc">+</span> nAssts <span class="sc">+</span> nError, <span class="at">data =</span> trainData)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(model_full)</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the regression results</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_full)<span class="sc">$</span>coefficients</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 Estimate   Std. Error    t value     Pr(&gt;|t|)
(Intercept)  4.2375266336 0.1761098353 24.0618397 3.840334e-60
nAtBat      -0.0020376716 0.0012826800 -1.5886048 1.137780e-01
nHits        0.0123668353 0.0047572285  2.5995882 1.005137e-02
nHome        0.0075023660 0.0117294886  0.6396158 5.231770e-01
nRuns       -0.0037564081 0.0059536028 -0.6309471 5.288178e-01
nRBI        -0.0006802062 0.0050769358 -0.1339797 8.935575e-01
nBB          0.0123192076 0.0035076666  3.5120806 5.530162e-04
YrMajor      0.0808472281 0.0235407122  3.4343578 7.262501e-04
CrAtBat      0.0001219822 0.0002559580  0.4765714 6.342037e-01
CrHits      -0.0006231532 0.0013109652 -0.4753392 6.350800e-01
CrHome      -0.0005426989 0.0030564221 -0.1775602 8.592537e-01
CrRuns       0.0014737384 0.0014467526  1.0186527 3.096365e-01
CrRbi        0.0003649257 0.0013122380  0.2780942 7.812362e-01
CrBB        -0.0015703150 0.0006199406 -2.5330089 1.210030e-02
nOuts        0.0004799025 0.0001641079  2.9243105 3.863220e-03
nAssts       0.0001766795 0.0004412550  0.4004023 6.893008e-01
nError      -0.0020374804 0.0091948797 -0.2215886 8.248672e-01</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Get the  p values</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(model_full)$coefficients[,4]</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the coefficients with p values less than 0.01</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(<span class="fu">which</span>(<span class="fu">summary</span>(model_full)<span class="sc">$</span>coefficients[,<span class="dv">4</span>]<span class="sc">&lt;</span>.<span class="dv">01</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "(Intercept)" "nBB"         "YrMajor"     "nOuts"      </code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">#confint(model_full, level = 0.99)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="question-2" class="level1">
<h1>Question 2</h1>
<p>Calculate the mean-squared prediction error (MSPE), the adjusted <span class="math inline">\(R^2\)</span> , AIC, and BIC criterion values for <strong>model_full.</strong> Enter your selection in Canvas by selecting the closest answer choice from the list.&nbsp;</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Insert your R code for Question 2 in here</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co"># HINTS: </span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co"># You can whether manually calculate or use a package to calculate MSPE</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjusted R Square is stored under model_full R object</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co"># You can consider using AIC() function in stats package to calculate the AIC value</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="co"># You can consider using BIC() function in stats package to calculate the BIC value</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co"># If you want to print all your answers in one dataframe you can just put it in a dataframe with   data.frame(MSPE=,  ADJR2=, AIC=, BIC=) or just print them separately </span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate MSPE, Adjusted R square, AIC, BIC criterion values for the best subset</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>MSPE_model_full<span class="ot">=</span><span class="fu">mean</span>(model_full<span class="sc">$</span>residuals<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>ADJR2_model_full<span class="ot">=</span><span class="fu">summary</span>(model_full)<span class="sc">$</span>adj.r.squared</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>AIC_model_full <span class="ot">=</span> <span class="fu">AIC</span>(model_full,<span class="at">k=</span><span class="dv">2</span>)</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>BIC_model_full <span class="ot">=</span> <span class="fu">AIC</span>(model_full,<span class="at">k=</span><span class="fu">log</span>(<span class="fu">nrow</span>(trainData)))</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>results_model_full <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">MSPE=</span>MSPE_model_full,  <span class="at">ADJR2=</span>ADJR2_model_full, <span class="at">AIC=</span>AIC_model_full, <span class="at">BIC=</span>BIC_model_full)</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>results_model_full</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       MSPE     ADJR2      AIC      BIC
1 0.2885564 0.5878716 372.5476 432.8811</code></pre>
</div>
</div>
</section>
<section id="section" class="level1">
<h1></h1>
<p>Question 3</p>
<p>So far, we did not do any feature selection. Instead, we have calculated the Adjusted R-squared, AIC, and BIC criterion values for the full model with all features are included as predictor in our largest model. In the following parts, we will choose the best sub-model based on one of these criterion values.</p>
<p>Now, your task is to predict <strong>logSalary</strong> with all the predictors in <strong>trainData,</strong> then calculate the mean squared prediction errors (MSPE) in the <strong>trainData</strong> based on 5-fold, 10-fold and leave one out cross-validation approaches?</p>
<p>Use <strong>cv.glm</strong> function in R to calculate the cross validated estimates. Use <strong>set.seed(5410)</strong> when you calculate the cross-validated estimates</p>
<p><strong>Note</strong>: Is there an increase or decrease in MSPE with cross validation? You should be able to tell why MSPE is going up with cross-validation method. Since we assume you all know why, you are not required to enter your response in Canvas.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Insert your R code for Question 3 in here</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co"># HINTS: </span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co"># You can first create a linear model with glm() function modglm=glm(logSalary ~ ., data = trainData), then call it inside the cv.glm() function</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co"># cv.glm(, K=5) gives  you the 5 fold-cross validation results</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="co"># cv.glm(, K=10) gives  you the 10 fold-cross validation results</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co"># cv.glm(, K=n) gives  you the LOOCV results when n is the number of rows in trainData</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="co"># cv.glm() R object stores two information under delta (cv.glm()$delta). The first information gives the  cross-validation estimate of prediction error, MSPE, that is the answer.  </span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">5410</span>)</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="co">#modglm=glm(logSalary ~ ., data = trainData)</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="co">#cv_5 &lt;- cv.glm(trainData, model_full, K = 10)</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="co">#print(cvfit$delta)</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>modglm<span class="ot">=</span><span class="fu">glm</span>(logSalary <span class="sc">~</span> ., <span class="at">data =</span> trainData)</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>cv_5 <span class="ot">&lt;-</span> <span class="fu">cv.glm</span>(trainData, modglm, <span class="at">K =</span> <span class="dv">5</span> )</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cv_5<span class="sc">$</span>delta[<span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3603185</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>cv_10 <span class="ot">&lt;-</span> <span class="fu">cv.glm</span>(trainData, modglm, <span class="at">K =</span> <span class="dv">10</span> )</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cv_10<span class="sc">$</span>delta[<span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3544171</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>cv_10 <span class="ot">&lt;-</span> <span class="fu">cv.glm</span>(trainData, modglm, <span class="at">K =</span> <span class="fu">nrow</span>(trainData) )</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cv_10<span class="sc">$</span>delta[<span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3530806</code></pre>
</div>
</div>
</section>
<section id="part-2-best-subset-model-search" class="level1">
<h1>Part 2: Best Subset Model Search</h1>
<p>You will only use <strong>trainData</strong> in Part 2.</p>
</section>
<section id="question-4" class="level1">
<h1>Question 4</h1>
<p>What is the total number of different models that can be built from all possible combinations of the predictors with p=16?</p>
<p>No coding is needed for Question 4. Just answer it in Canvas.</p>
<p>2^16 = 65,536</p>
</section>
<section id="question-5" class="level1">
<h1>Question 5</h1>
<p>Warning: This question can be challenging.</p>
<p>In this part, we will use <strong>leaps</strong> function in the <strong>leaps</strong> library in R to compare all possible models and decide on the best model by using Adjusted R-squared criteria on <strong>trainData</strong>.</p>
<p>Which set of predictors will give you the highest Adjusted R-squared value when we use the <strong><em>trainData</em></strong> to train all possible subset models. Use <strong>leaps</strong> function in the <strong>leaps</strong> library in R to compare all possible models and decide on the best model. You can use leaps package and set the <strong>nbest</strong> parameter to <strong>1</strong> to get the desired table.</p>
<p>The leaps function in R can help you to construct a table indicating the variables included in the best model of each size (p=1,p=2,â€¦, p=16) and the corresponding Adjusted R-squared value. Hint: The table must include 16 rows, the best subset for each k. Check the lab help recordings for the details. You can use leaps package and set the nbest parameter to 1 to get the desired table. Alternatively, you can use `regsubsets` function in leaps package to get the same results.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Insert your R code for Question 5 in here</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="co"># HINTS: </span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co"># You can store the predictor names with  col_names = names(trainData)[-17] and insert it into leaps() function as names= col_names)</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co"># nbest=1 will give   you the highest performing model for each set (models with  only 1 predictor, models  with only two predictors, ,,,,, models  with only 16 predictor)</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="co"># After creating the leaps object, tou can first fet the index of best model with which () function, then print the best AdjR2 values for each set</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="co"># In the leaps () output, the coefficient 1 in front a coefficient indicates it has been selected on that set, O means not selected</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the column names for predictors: we need this to create a table of results</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(trainData)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "nAtBat"    "nHits"     "nHome"     "nRuns"     "nRBI"      "nBB"      
 [7] "YrMajor"   "CrAtBat"   "CrHits"    "CrHome"    "CrRuns"    "CrRbi"    
[13] "CrBB"      "nOuts"     "nAssts"    "nError"    "logSalary"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Exclude the target variable from the list</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="co">#trainData_subset &lt;- subset(trainData, select = -c(logSalary))</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="co">#column_names &lt;- names(trainData_subset)</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>column_names <span class="ot">&lt;-</span> <span class="fu">names</span>(trainData)[<span class="sc">-</span><span class="dv">17</span>]</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>bestsubsets_fullR2 <span class="ot">&lt;-</span> <span class="fu">leaps</span>(trainData[,<span class="sc">-</span><span class="dv">17</span>], trainData<span class="sc">$</span>logSalary, <span class="at">method =</span> <span class="st">"adjr2"</span>, <span class="at">nbest=</span><span class="dv">1</span>, <span class="at">names =</span> column_names)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="co">#bestsubsets_fullR2</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Put them all in a table </span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>table_bestsubset <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">as.matrix</span>(bestsubsets_fullR2<span class="sc">$</span>which),<span class="at">AdjR2=</span>bestsubsets_fullR2<span class="sc">$</span>adjr2)</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>table_bestsubset</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   nAtBat nHits nHome nRuns nRBI nBB YrMajor CrAtBat CrHits CrHome CrRuns CrRbi
1       0     0     0     0    0   0       0       0      1      0      0     0
2       0     1     0     0    0   0       1       0      0      0      0     0
3       0     1     0     0    0   0       1       0      0      0      0     0
4       0     1     0     0    0   1       1       0      0      0      0     0
5       1     1     0     0    0   1       1       0      0      0      0     0
6       0     1     0     0    0   1       1       0      0      0      1     0
7       1     1     0     0    0   1       1       0      0      0      1     0
8       1     1     1     0    0   1       1       0      0      0      1     0
9       1     1     1     1    0   1       1       0      0      0      1     0
10      1     1     1     1    0   1       1       0      0      0      1     0
11      1     1     1     1    0   1       1       1      1      0      1     0
12      1     1     1     1    0   1       1       1      1      0      1     0
13      1     1     1     1    0   1       1       1      1      0      1     1
14      1     1     1     1    0   1       1       1      1      0      1     1
15      1     1     1     1    0   1       1       1      1      1      1     1
16      1     1     1     1    1   1       1       1      1      1      1     1
   CrBB nOuts nAssts nError     AdjR2
1     0     0      0      0 0.3991530
2     0     0      0      0 0.5550871
3     0     1      0      0 0.5779299
4     0     1      0      0 0.5915113
5     0     1      0      0 0.5917413
6     1     1      0      0 0.6004069
7     1     1      0      0 0.6027846
8     1     1      0      0 0.6020964
9     1     1      0      0 0.6009040
10    1     1      1      0 0.5992226
11    1     1      0      0 0.5976562
12    1     1      1      0 0.5958257
13    1     1      1      0 0.5939510
14    1     1      1      1 0.5919916
15    1     1      1      1 0.5899472
16    1     1      1      1 0.5878716</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Choose your best model by the one with the highest R square value</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Find  which row has the highest Adjusted R squares value</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>bestmodeladjr2 <span class="ot">=</span> <span class="fu">which</span>(bestsubsets_fullR2<span class="sc">$</span>adjr2<span class="sc">==</span><span class="fu">max</span>(bestsubsets_fullR2<span class="sc">$</span>adjr2))</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="co">#bestmodeladjr2</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the coefficients of the best model</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>best.adjr2 <span class="ot">=</span> <span class="fu">cbind</span>(<span class="fu">as.matrix</span>(bestsubsets_fullR2<span class="sc">$</span>which),bestsubsets_fullR2<span class="sc">$</span>adjr2)[bestmodeladjr2,]</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>best.adjr2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   nAtBat     nHits     nHome     nRuns      nRBI       nBB   YrMajor   CrAtBat 
1.0000000 1.0000000 0.0000000 0.0000000 0.0000000 1.0000000 1.0000000 0.0000000 
   CrHits    CrHome    CrRuns     CrRbi      CrBB     nOuts    nAssts    nError 
0.0000000 0.0000000 1.0000000 0.0000000 1.0000000 1.0000000 0.0000000 0.0000000 
          
0.6027846 </code></pre>
</div>
</div>
</section>
<section id="part-3-regularized-regression" class="level1">
<h1>Part 3: Regularized Regression</h1>
<p>You will only use <strong>trainData</strong> in Part 3.</p>
</section>
<section id="question-6" class="level1">
<h1>Question 6</h1>
<p>Now, we will use the <strong>trainData</strong> and perform RIDGE regression on the full model (<strong>model_full</strong>). Before performing Ridge regression, we need to standardize the predictors but there are some packages that standardize variables for you. In that case, there is no need to standardize predictors twice. For this RLab assignment, please use <strong>glmnet</strong> package so that you do not have to worry about standardizing your features.</p>
<p>Your task is to write an R code to apply Ridge regression on <strong>trainData</strong> set with <strong>10-fold cross validation</strong>. Print the optimized lambda value and the minimum mean cross-validated Error. Keep the default loss function (t<strong>ype.measure=â€œmseâ€</strong>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Insert your R code for Question 6 in here</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="co"># HINTS: </span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="co"># in cv.glmnet() function choose  family='gaussian', type.measure="mse", alpha=0, nfolds=10 for the desired results</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="co"># optimized lamba is stored under the cv.glmnet() R object</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Minimum Mean CV Error is stored under cv.glmnet() R object</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Optimize lambda using 10-fold cross validation</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>y.train <span class="ot">=</span> trainData<span class="sc">$</span>logSalary</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>predictors.train <span class="ot">=</span> trainData[,<span class="sc">-</span><span class="dv">17</span>]</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>y.test <span class="ot">=</span> testData<span class="sc">$</span>logSalary</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>predictors.test <span class="ot">=</span> testData[,<span class="sc">-</span><span class="dv">17</span>]</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">5410</span>)</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Optimize lambda using 10-fold cross validation, keep the default lambda selection</span></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>RidgeCV <span class="ot">=</span> <span class="fu">cv.glmnet</span>(<span class="fu">as.matrix</span>(predictors.train), y.train,</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>                     <span class="at">family=</span><span class="st">'gaussian'</span>, <span class="at">type.measure=</span><span class="st">"mse"</span>, <span class="at">alpha=</span><span class="dv">1</span>, <span class="at">nfolds=</span><span class="dv">10</span>)</span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a><span class="co"># plot</span></span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(RidgeCV)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Week-4-Assignment_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check the values of lambda used in the fits</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>RidgeCV<span class="sc">$</span>lambda</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 5.519866e-01 5.029497e-01 4.582690e-01 4.175577e-01 3.804630e-01
 [6] 3.466637e-01 3.158671e-01 2.878063e-01 2.622384e-01 2.389418e-01
[11] 2.177149e-01 1.983737e-01 1.807507e-01 1.646933e-01 1.500624e-01
[16] 1.367313e-01 1.245845e-01 1.135167e-01 1.034322e-01 9.424359e-02
[21] 8.587125e-02 7.824268e-02 7.129182e-02 6.495845e-02 5.918772e-02
[26] 5.392964e-02 4.913868e-02 4.477334e-02 4.079580e-02 3.717161e-02
[31] 3.386939e-02 3.086053e-02 2.811896e-02 2.562095e-02 2.334486e-02
[36] 2.127096e-02 1.938131e-02 1.765953e-02 1.609070e-02 1.466125e-02
[41] 1.335878e-02 1.217203e-02 1.109070e-02 1.010543e-02 9.207692e-03
[46] 8.389706e-03 7.644388e-03 6.965281e-03 6.346505e-03 5.782699e-03
[51] 5.268980e-03 4.800898e-03 4.374400e-03 3.985790e-03 3.631704e-03
[56] 3.309073e-03 3.015104e-03 2.747251e-03 2.503192e-03 2.280816e-03
[61] 2.078194e-03 1.893573e-03 1.725353e-03 1.572078e-03 1.432419e-03
[66] 1.305167e-03 1.189219e-03 1.083572e-03 9.873107e-04 8.996007e-04
[71] 8.196826e-04 7.468643e-04 6.805149e-04 6.200599e-04 5.649755e-04
[76] 5.147846e-04 4.690525e-04 4.273832e-04 3.894157e-04 3.548211e-04
[81] 3.232997e-04 2.945787e-04 2.684091e-04 2.445644e-04 2.228380e-04
[86] 2.030417e-04 1.850040e-04 1.685687e-04 1.535936e-04 1.399487e-04
[91] 1.275161e-04 1.161879e-04 1.058661e-04 9.646123e-05 8.789188e-05</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check the mean cross-validated error for each lambda used</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>RidgeCV<span class="sc">$</span>cvm </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 0.7626211 0.7187932 0.6760854 0.6392750 0.5997779 0.5604548 0.5271149
 [8] 0.4992653 0.4757857 0.4561568 0.4394270 0.4245270 0.4101772 0.3974488
[15] 0.3863127 0.3761086 0.3671351 0.3597222 0.3535889 0.3485056 0.3442905
[22] 0.3407671 0.3378377 0.3354091 0.3333952 0.3317336 0.3304095 0.3293499
[29] 0.3285591 0.3279986 0.3276412 0.3274580 0.3273982 0.3274368 0.3274758
[36] 0.3275753 0.3276430 0.3277422 0.3279767 0.3284754 0.3291566 0.3297704
[43] 0.3303295 0.3304384 0.3308049 0.3314659 0.3323501 0.3332565 0.3341670
[50] 0.3350029 0.3358140 0.3363474 0.3368794 0.3374337 0.3378634 0.3382775
[57] 0.3386807 0.3389410 0.3392166 0.3395085 0.3398727 0.3402306 0.3405162
[64] 0.3407739 0.3410502 0.3412376 0.3415589 0.3418119 0.3421818 0.3426265
[71] 0.3431192 0.3436312 0.3441581 0.3446797 0.3452148 0.3456916 0.3460967
[78] 0.3464822 0.3467951 0.3470576 0.3473081 0.3476005 0.3478981 0.3481523
[85] 0.3483630 0.3485405 0.3487013 0.3488507 0.3489915 0.3491191 0.3492364
[92] 0.3493366 0.3494263 0.3495150 0.3495930</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get the minimum mean cross-validated error </span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(RidgeCV<span class="sc">$</span>cvm) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3273982</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># number of non-zero coefficients at each lambda. For Ridge, it is all same and equal to number of predictors</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>RidgeCV<span class="sc">$</span>nzero</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> s0  s1  s2  s3  s4  s5  s6  s7  s8  s9 s10 s11 s12 s13 s14 s15 s16 s17 s18 s19 
  0   1   2   2   3   3   3   4   4   4   4   5   5   5   6   7   7   7   7   7 
s20 s21 s22 s23 s24 s25 s26 s27 s28 s29 s30 s31 s32 s33 s34 s35 s36 s37 s38 s39 
  7   7   7   7   7   7   7   7   7   7   7   7   7   7   8   9   9   9   9   9 
s40 s41 s42 s43 s44 s45 s46 s47 s48 s49 s50 s51 s52 s53 s54 s55 s56 s57 s58 s59 
 10  10  10  10  10   9  10  11  11  12  12  12  12  13  13  13  13  13  13  13 
s60 s61 s62 s63 s64 s65 s66 s67 s68 s69 s70 s71 s72 s73 s74 s75 s76 s77 s78 s79 
 14  14  15  15  15  14  14  14  14  14  14  14  14  15  15  15  15  15  15  15 
s80 s81 s82 s83 s84 s85 s86 s87 s88 s89 s90 s91 s92 s93 s94 
 16  16  16  16  16  16  16  16  16  16  16  16  16  15  15 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get the value of lambda which gives you the minimum cross-validated error</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>RidgeCV<span class="sc">$</span>lambda.min</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.02811896</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the best lambda and predict the target variable in the test set, calculate MSPE</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>RidgePredictTest<span class="ot">&lt;-</span><span class="fu">predict</span>(RidgeCV,<span class="at">s=</span>RidgeCV<span class="sc">$</span>lambda.min,<span class="at">newx=</span><span class="fu">as.matrix</span>(predictors.test))</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the MSPE in the test set</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>MSPE_Ridge_test<span class="ot">&lt;-</span><span class="fu">mean</span>((RidgePredictTest<span class="sc">-</span>y.test)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a><span class="co">#NEXT STEP</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a><span class="co"># We used cross validation in the train data to get the optimal lambda</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a><span class="co"># We used test data to ESTIMATE test error with the best lambda found in the train data</span></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a><span class="co">#Now, REFIT the RIDGE Regression model on the FULL data set, use the value of lambda chosen by cross-validation  and check the coefficient estimates</span></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a><span class="co"># First, we fit Ridge Regression </span></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">5410</span>)</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a><span class="co"># write down the model , since we no longer need cross validation, we just use glmnet functiom (not the cv.glmnet function)</span></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a><span class="co"># we first create the object, then try to get the fitted value for a given lambda</span></span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>FullRidgeModel<span class="ot">&lt;-</span><span class="fu">glmnet</span>(trainData[,<span class="sc">-</span><span class="dv">1</span>], trainData<span class="sc">$</span>logSalary,<span class="at">family=</span><span class="st">'gaussian'</span>, <span class="at">type.measure=</span><span class="st">"mse"</span>, <span class="at">alpha=</span><span class="dv">0</span>)</span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a><span class="co"># get the predicted values with optimal lambda found with cross validation</span></span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>FullRidgeModelPredict<span class="ot">&lt;-</span><span class="fu">predict</span>(FullRidgeModel,<span class="at">type=</span><span class="st">"coefficients"</span>, <span class="at">s=</span>RidgeCV<span class="sc">$</span>lambda.min)</span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>FullRidgeModelPredict</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>17 x 1 sparse Matrix of class "dgCMatrix"
                       s1
(Intercept)  8.329659e-01
nHits        7.876076e-04
nHome        2.163827e-05
nRuns        4.324797e-04
nRBI         3.278399e-04
nBB          1.125466e-03
YrMajor      9.561209e-03
CrAtBat      6.073529e-06
CrHits       2.880560e-05
CrHome      -1.291931e-05
CrRuns       3.550182e-05
CrRbi        3.638908e-05
CrBB        -6.404061e-05
nOuts        8.402736e-05
nAssts       2.256302e-05
nError      -9.398184e-04
logSalary    8.075086e-01</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># OR</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(FullRidgeModel,<span class="at">s=</span>RidgeCV<span class="sc">$</span>lambda.min)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>17 x 1 sparse Matrix of class "dgCMatrix"
                       s1
(Intercept)  8.329659e-01
nHits        7.876076e-04
nHome        2.163827e-05
nRuns        4.324797e-04
nRBI         3.278399e-04
nBB          1.125466e-03
YrMajor      9.561209e-03
CrAtBat      6.073529e-06
CrHits       2.880560e-05
CrHome      -1.291931e-05
CrRuns       3.550182e-05
CrRbi        3.638908e-05
CrBB        -6.404061e-05
nOuts        8.402736e-05
nAssts       2.256302e-05
nError      -9.398184e-04
logSalary    8.075086e-01</code></pre>
</div>
</div>
</section>
<section id="question-7" class="level1">
<h1>Question 7</h1>
<p>Now, we will use the <strong>trainData</strong> and perform <strong>LASSO</strong> regression on the full model (<strong>model_full</strong>). Please use <strong>glmnet</strong> package so that you do not have to worry about standardizing your features.</p>
<p>Your task is to write an R code to apply <strong>LASSO</strong> regression on <strong>trainData</strong> set with <strong>10-fold cross validation.</strong> Print the optimized lambda value and the minimum mean cross-validated Error. Keep the default loss function (type.measure=â€œmseâ€).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Insert your R code for Question 7 in here</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="co"># HINTS: </span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="co"># in cv.glmnet() function choose  family='gaussian', type.measure="mse", alpha=0, nfolds=10 for the desired results</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="co"># optimized lamba is stored under the cv.glmnet() R object</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Minimum Mean CV Error is stored under cv.glmnet() R object</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Find the optimal lambda using 10-fold CV </span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a><span class="co"># set alpha=1  for LASSO</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a><span class="co"># predictors and the target variable already defined</span></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>y.train <span class="ot">=</span> trainData<span class="sc">$</span>logSalary</span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>predictors.train <span class="ot">=</span> trainData[,<span class="sc">-</span><span class="dv">17</span>]</span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>y.test <span class="ot">=</span> testData<span class="sc">$</span>logSalary</span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>predictors.test <span class="ot">=</span> testData[,<span class="sc">-</span><span class="dv">17</span>]</span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a><span class="do">## PERFORM CROSS VALIDATION</span></span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">5410</span>)</span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Optimize lambda using 10-fold cross validation, keep the default lambda selection</span></span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a>LassoCV <span class="ot">=</span> <span class="fu">cv.glmnet</span>(<span class="fu">as.matrix</span>(predictors.train), y.train,</span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a>                     <span class="at">family=</span><span class="st">'gaussian'</span>, <span class="at">type.measure=</span><span class="st">"mse"</span>, <span class="at">alpha=</span><span class="dv">1</span>, <span class="at">nfolds=</span><span class="dv">10</span>)</span>
<span id="cb40-25"><a href="#cb40-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-26"><a href="#cb40-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-27"><a href="#cb40-27" aria-hidden="true" tabindex="-1"></a><span class="co"># check the values of lambda used in the fits</span></span>
<span id="cb40-28"><a href="#cb40-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-29"><a href="#cb40-29" aria-hidden="true" tabindex="-1"></a><span class="co"># &gt; LassoCV$lambda</span></span>
<span id="cb40-30"><a href="#cb40-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-31"><a href="#cb40-31" aria-hidden="true" tabindex="-1"></a><span class="co"># check the mean cross-validated error for each lambda used</span></span>
<span id="cb40-32"><a href="#cb40-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-33"><a href="#cb40-33" aria-hidden="true" tabindex="-1"></a><span class="co"># &gt; LassoCV$cvm </span></span>
<span id="cb40-34"><a href="#cb40-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-35"><a href="#cb40-35" aria-hidden="true" tabindex="-1"></a><span class="co"># get the minimum mean cross-validated error </span></span>
<span id="cb40-36"><a href="#cb40-36" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(LassoCV<span class="sc">$</span>cvm) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3273982</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># optimal lambda</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>LassoCV<span class="sc">$</span>lambda.min</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.02811896</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># number of non-zero coefficients at each lambda. </span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>LassoCV<span class="sc">$</span>nzero</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> s0  s1  s2  s3  s4  s5  s6  s7  s8  s9 s10 s11 s12 s13 s14 s15 s16 s17 s18 s19 
  0   1   2   2   3   3   3   4   4   4   4   5   5   5   6   7   7   7   7   7 
s20 s21 s22 s23 s24 s25 s26 s27 s28 s29 s30 s31 s32 s33 s34 s35 s36 s37 s38 s39 
  7   7   7   7   7   7   7   7   7   7   7   7   7   7   8   9   9   9   9   9 
s40 s41 s42 s43 s44 s45 s46 s47 s48 s49 s50 s51 s52 s53 s54 s55 s56 s57 s58 s59 
 10  10  10  10  10   9  10  11  11  12  12  12  12  13  13  13  13  13  13  13 
s60 s61 s62 s63 s64 s65 s66 s67 s68 s69 s70 s71 s72 s73 s74 s75 s76 s77 s78 s79 
 14  14  15  15  15  14  14  14  14  14  14  14  14  15  15  15  15  15  15  15 
s80 s81 s82 s83 s84 s85 s86 s87 s88 s89 s90 s91 s92 s93 s94 
 16  16  16  16  16  16  16  16  16  16  16  16  16  15  15 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># numnber of features at the optimal lambda</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>LassoCV<span class="sc">$</span>nzero[LassoCV<span class="sc">$</span>lambda <span class="sc">==</span> LassoCV<span class="sc">$</span>lambda.min]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>s32 
  7 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the best lambda and predict the target variable in the test set with Lasso and  calculate MSPE</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>LassoPredictTest<span class="ot">&lt;-</span><span class="fu">predict</span>(LassoCV,<span class="at">s=</span>LassoCV<span class="sc">$</span>lambda.min,<span class="at">newx=</span><span class="fu">as.matrix</span>(predictors.test))</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>MSPE_Lasso_test<span class="ot">&lt;-</span><span class="fu">mean</span>((LassoPredictTest<span class="sc">-</span>y.test)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>MSPE_Lasso_test</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4287379</code></pre>
</div>
</div>
</section>
<section id="question-8" class="level1">
<h1>Question 8</h1>
<p>Which variables were selected based on LASSO?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Insert your R code for Question 7 in here</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="co"># HINTS: use coef() to extract the coefficients. Any coefficient with 0 estimate is dropped from the regression</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="co">#NEXT STEP</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a><span class="co"># We used cross validation in the train data to get the optimal lambda</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a><span class="co"># We used test data to ESTIMATE test error with the best lambda found in the train data</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Now, REFIT the Lasso Regression model on the FULL data set, use the value of lambda chosen by cross-validation  and check the coefficient estimates</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">5410</span>)</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a><span class="co"># write down the model with ALL observations</span></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>FullLassoModel <span class="ot">&lt;-</span> <span class="fu">glmnet</span>(trainData[,<span class="sc">-</span><span class="dv">17</span>], trainData<span class="sc">$</span>logSalary,<span class="at">family=</span><span class="st">'gaussian'</span>, <span class="at">type.measure=</span><span class="st">"mse"</span>, <span class="at">alpha=</span><span class="dv">1</span>)</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a><span class="co"># get the predicted values with optimal lambda</span></span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>FullLassoModelPredict <span class="ot">&lt;-</span> <span class="fu">predict</span>(FullLassoModel,<span class="at">type=</span><span class="st">"coefficients"</span>, <span class="at">s=</span>LassoCV<span class="sc">$</span>lambda.min)</span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(FullLassoModelPredict, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>17 x 1 sparse Matrix of class "dgCMatrix"
               s1
(Intercept) 4.261
nAtBat      .    
nHits       0.006
nHome       .    
nRuns       .    
nRBI        0.001
nBB         0.005
YrMajor     0.065
CrAtBat     .    
CrHits      0.000
CrHome      .    
CrRuns      .    
CrRbi       0.000
CrBB        .    
nOuts       0.000
nAssts      .    
nError      .    </code></pre>
</div>
</div>
<p><strong>Optional</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>OLSmodel<span class="ot">&lt;-</span><span class="fu">lm</span>(logSalary <span class="sc">~</span> . , <span class="at">data=</span>trainData)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>OLSPredictTest<span class="ot">&lt;-</span><span class="fu">predict</span>(OLSmodel,<span class="at">newx=</span><span class="fu">as.matrix</span>(predictors.test))</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>MSPE_OLS_test<span class="ot">&lt;-</span><span class="fu">mean</span>((OLSPredictTest<span class="sc">-</span>y.test)<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in OLSPredictTest - y.test: longer object length is not a multiple of
shorter object length</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># performance comparison</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="co"># OLS</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>MSPE_OLS_test</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.436267</code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ridge</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>MSPE_Ridge_test</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4287379</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Lasso</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>MSPE_Lasso_test</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4287379</code></pre>
</div>
</div>
</section>
<section id="part-4" class="level1">
<h1>PART 4</h1>
<p>You will only use <strong>testData</strong> in Part 4.</p>
<p>Now, it is time to put all the fitted models a test. Predict <strong>logSalary</strong> for each of the rows in the test data, <strong>testData</strong>, using model_full in Part 1, best subset model in Part 2, and Ridge and Lasso Regression models in Part 3.</p>
<p>Calculate the MSPE on the test set for each model and insert your answer in Canvas.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  Insert your R code for Question 7 in here</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>